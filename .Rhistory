t = 112,
l = 80,
r = 40,
b = 60
)
)
#| label: PCA_inter
#| code-summary: Principal Component Analysis (Interactive)
plot_ly(
data = pca_res,
x = ~PC1,
y = ~PC2,
color = ~Group,
colors = cols_standard,
type = "scatter",
mode = "markers",
marker = list(size = 8),
text = ~paste0(
"Sample: ", Samples,
"<br>Group: ", Group
),
hoverinfo = "text"
) %>%
layout(
title = list(
text = "<b>PCA Plot</b><br><i>ProjectID 000</i>",
x = 0.5,
yanchor = "top"
),
xaxis = list(title = paste0("PC1 (",percentVar[1],"%)")),
yaxis = list(title = paste0("PC2 (",percentVar[2],"%)")),
margin = list(
t = 112,
l = 80,
r = 40,
b = 60
)
)
da_res = data.frame(UniProt=paste0("ID_",1:K),Name=paste0("Protein_",1:K),
pval=rbeta(n = K))
#| label: VP_static
#| code-summary: Volcano Plot (Static)
K=1000
da_res = data.frame(UniProt=paste0("ID_",1:K),Name=paste0("Protein_",1:K),
pval=rbeta(n = K,shape1 = 1,shape2 = 1))
#| label: setup
#| code-summary: R setup
# Setting up the working directory. Although the opts_knit should be enough, I tend to overkill it with `setwd()`
knitr::opts_knit$set(root.dir = "C:/Users/asbarros/OneDrive - FUNDAÇÃO GIMM - GULBENKIAN INSTITUTE FOR MOLECULAR MEDICINE/ADA/Proteomics/DNA_009/")
# --- Libraries --- #
library(tidyverse)
library(plotly)
# --- Set my theme & colors for ggplot2 --- #
theme_set(theme_bw()+
theme(strip.background=element_rect(fill="black"),
strip.text = element_text(color="white",size=12),
plot.title = element_text(size=16,hjust=0.5,face="bold"),
plot.subtitle = element_text(size=12,hjust=0.5,face="italic")))
cols_standard = c("#000000","#009E73")
cols_VP=c("DownReg"="darkblue","UpReg"="darkred")
# --- Create the output folders  --- #
dir.create("01_PreliminaryAnalysis",showWarnings = F)
dir.create("02_PCA/",showWarnings = F)
dir.create("03_DEG/",showWarnings = F)
#| label: logIntensities
#| code-summary: Assessment of log2 Intensities (Static)
K=1000
mu=1E5
sig = 5E2
df = data.frame(A1=rnorm(K,mu,sig),A2=rnorm(K,mu,sig),A3=rnorm(K,mu,sig),
B1=rnorm(K,mu,sig),B2=rnorm(K,mu,sig),B3=rnorm(K,mu,sig))
rownames(df) = paste0("ID_",1:K)
df_long = df %>%
mutate(UniProt=rownames(.)) %>%
pivot_longer(cols = -c(UniProt),
names_to = "Samples",values_to = "Intensities") %>%
mutate(Group=case_when(
grepl("A",Samples)==T ~ "A",
grepl("B",Samples)==T ~ "B"
))
g1 = ggplot(data=df_long,aes(x=Samples,y=log2(Intensities),color=Group))+
geom_boxplot(fill=NA,outlier.shape=NA) +
geom_point(size=2,position=position_jitter(h=0,w=0.05))+
scale_color_manual(values=cols_standard)+
labs(title="Log2 Intensities",subtitle="ProjectID 000",
y = expression(log[2]~"Intensities"))
pdf("01_PreliminaryAnalysis/log2Intensities.pdf", width=8,height=6)
g1
invisible(dev.off())
g1
#| label: logIntensities_inter
#| code-summary: Assessment of log2 Intensities (Interactive)
df_long$hover_label <- paste0(
"UniProt: ", df_long$UniProt,
"<br>",
"log<sub>2</sub> Intensity: ", round(log2(df_long$Intensities), 1)
)
plot_ly(
data = df_long,
x = ~Samples,
y = ~log2(Intensities),
color = ~Group,
colors = cols_standard,
type = "box",
boxpoints = "all",
jitter = 0.4,
pointpos = 0,
marker = list(size = 4),
text = ~hover_label,
hoverinfo = "text"
) %>%
layout(
title = list(
text = "<b>Log2 Intensities</b><br><i>ProjectID 000</i>",
x = 0.5
),
xaxis = list(title = "Samples"),
yaxis = list(title = "log<sub>2</sub> Intensities"),
legend = list(title = list(text = "Group"))
)
#| label: PCA_plot
#| code-summary: Principal Component Analysis (Static)
p1 = prcomp(t(df),center = T,scale. = T)
pca_res = p1$x %>%
as.data.frame() %>%
mutate(Samples=rownames(.)) %>%
mutate(Group=case_when(
grepl("A",Samples)==T ~ "A",
grepl("B",Samples)==T ~ "B"
))
percentVar <- round(100*(p1$sdev^2 / sum(p1$sdev^2)),2)
g2 = ggplot(data=pca_res,aes(x=PC1,y=PC2,color=Group))+
geom_point(size=3)+
scale_color_manual(values=cols_standard)+
labs(title="PCA Plot",subtitle="ProjectID 000",
x=paste0("PC1 (",percentVar[1],"%)"),y=paste0("PC2 (",percentVar[2],"%)"))
pdf("02_PCA/PCA.pdf", width=8,height=6)
g2
invisible(dev.off())
g2
#| label: PCA_inter
#| code-summary: Principal Component Analysis (Interactive)
plot_ly(
data = pca_res,
x = ~PC1,
y = ~PC2,
color = ~Group,
colors = cols_standard,
type = "scatter",
mode = "markers",
marker = list(size = 8),
text = ~paste0(
"Sample: ", Samples,
"<br>Group: ", Group
),
hoverinfo = "text"
) %>%
layout(
title = list(
text = "<b>PCA Plot</b><br><i>ProjectID 000</i>",
x = 0.5,
yanchor = "top"
),
xaxis = list(title = paste0("PC1 (",percentVar[1],"%)")),
yaxis = list(title = paste0("PC2 (",percentVar[2],"%)")),
margin = list(
t = 112,
l = 80,
r = 40,
b = 60
)
)
#| label: VP_static
#| code-summary: Volcano Plot (Static)
K=1000
da_res = data.frame(UniProt=paste0("ID_",1:K),Name=paste0("Protein_",1:K),
pval=rbeta(n = K,shape1 = 1,shape2 = 1),
lgFC=rnorm(n = K,mean = 0,sd = 5)) %>%
mutate(Sign=ifelse(lgFC<0,"DownReg","UpReg"))
g3 = ggplot(data=da_res,aes(x=lgFC,y=-log10(pval),color=Sign))+
geom_point(size=2)+
scale_color_manual(values=cols_VP)+
labs(title="Volcano Plot",subtitle="ProjectID 000",
x = expression(log[2]~"Fold Change"),
y = expression(-log[10]~"p-value"))
pdf("03_DEG/VolcanoPlot.pdf", width=8,height=6)
g3
invisible(dev.off())
g3
#| label: VP_static
#| code-summary: Volcano Plot (Static)
K=1000
da_res = data.frame(UniProt=paste0("ID_",1:K),Name=paste0("Protein_",1:K),
pval=rbeta(n = K,shape1 = 1,shape2 = 1),
lgFC=rnorm(n = K,mean = 0,sd = 5)) %>%
mutate(Sign=ifelse(lgFC<0,"DownReg","UpReg"))
g3 = ggplot(data=da_res,aes(x=lgFC,y=-log10(pval),color=Sign))+
geom_point(size=2)+
scale_color_manual(values=cols_VP)+
labs(title="Volcano Plot",subtitle="ProjectID 000",
x = expression(log[2]~"Fold Change"),
y = expression(-log[10]~"p-value"))+
geom_hline(yintercept = -log10(0.05),linetype="dashed",color="darkgrey")+
theme(legend.position = "none")
pdf("03_DEG/VolcanoPlot.pdf", width=8,height=6)
g3
invisible(dev.off())
g3
da_res %>% head()
#| label: VP_inter
#| code-summary: Volcano Plot (Interactive)
plot_ly(
data = da_res,
x = ~lgFC,
y=~ -log10(pval),
color = ~Sign,
colors = cols_VP,
type = "scatter",
mode = "markers",
marker = list(size = 8),
text = ~paste0(
"UniProtID: ", Uniprot,
"<br>Protein: ", Name,
"<br>p= ",round(pval,4),
"<br>FC= ",round(lgFC,2)
),
hoverinfo = "text"
) %>%
layout(
title = list(
text = "<b>Volcano Plot</b><br><i>ProjectID 000</i>",
x = 0.5,
yanchor = "top"
),
xaxis = list(title = "log<sub>2</sub> Fold Change"),
yaxis = list(title = "-log<sub>10</sub> p-value")),
#| label: VP_inter
#| code-summary: Volcano Plot (Interactive)
plot_ly(
data = da_res,
x = ~lgFC,
y=~ -log10(pval),
color = ~Sign,
colors = cols_VP,
type = "scatter",
mode = "markers",
marker = list(size = 8),
text = ~paste0(
"UniProtID: ", Uniprot,
"<br>Protein: ", Name,
"<br>p= ",round(pval,4),
"<br>FC= ",round(lgFC,2)
),
hoverinfo = "text"
) %>%
layout(
title = list(
text = "<b>Volcano Plot</b><br><i>ProjectID 000</i>",
x = 0.5,
yanchor = "top"
),
xaxis = list(title = "log<sub>2</sub> Fold Change"),
yaxis = list(title = "-log<sub>10</sub> p-value"),
margin = list(
t = 112,
l = 80,
r = 40,
b = 60
)
)
#| label: VP_inter
#| code-summary: Volcano Plot (Interactive)
plot_ly(
data = da_res,
x = ~lgFC,
y=~ -log10(pval),
color = ~Sign,
colors = cols_VP,
type = "scatter",
mode = "markers",
marker = list(size = 8),
text = ~paste0(
"UniProtID: ", UniProt,
"<br>Protein: ", Name,
"<br>p= ",round(pval,4),
"<br>FC= ",round(lgFC,2)
),
hoverinfo = "text"
) %>%
layout(
title = list(
text = "<b>Volcano Plot</b><br><i>ProjectID 000</i>",
x = 0.5,
yanchor = "top"
),
xaxis = list(title = "log<sub>2</sub> Fold Change"),
yaxis = list(title = "-log<sub>10</sub> p-value"),
margin = list(
t = 112,
l = 80,
r = 40,
b = 60
)
)
#| label: VP_inter
#| code-summary: Volcano Plot (Interactive)
plot_ly(
data = da_res,
x = ~lgFC,
y=~ -log10(pval),
color = ~Sign,
colors = cols_VP,
type = "scatter",
mode = "markers",
marker = list(size = 8),
text = ~paste0(
"UniProtID: ", UniProt,
"<br>Protein: ", Name,
"<br>p= ",round(pval,4),
"<br>FC= ",round(lgFC,2)
),
hoverinfo = "text"
) %>%
layout(
title = list(
text = "<b>Volcano Plot</b><br><i>ProjectID 000</i>",
x = 0.5,
yanchor = "top"
),
xaxis = list(title = "log<sub>2</sub> Fold Change"),
yaxis = list(title = "-log<sub>10</sub> p-value"),
margin = list(
t = 112,
l = 80,
r = 40,
b = 60
),showlegend = FALSE
)
library(tidyverse)
setwd("C:/Users/asbarros/OneDrive - FUNDAÇÃO GIMM - GULBENKIAN INSTITUTE FOR MOLECULAR MEDICINE/ADA/BSSantos/TRANS_017/")
library(tidyverse)
setwd("C:/Users/asbarros/OneDrive - FUNDAÇÃO GIMM - GULBENKIAN INSTITUTE FOR MOLECULAR MEDICINE/ADA/BSSantos/TRANS_017/")
Universal = read.csv("docs/AbInfo/TotalSeqC_Human_UniversalCocktail_CellRanger.csv")
Hashtags = read.csv("docs/AbInfo/TotalSeqC_Human_HashtagAntibodies.csv")
WorkSet = read.csv("data/98_miscellaneous/TRANS_017_Antibodies.csv")
WorkSet
library(tidyverse)
setwd("C:/Users/asbarros/OneDrive - FUNDAÇÃO GIMM - GULBENKIAN INSTITUTE FOR MOLECULAR MEDICINE/ADA/BSSantos/TRANS_017/")
Universal = read.csv("docs/AbInfo/TotalSeqC_Human_UniversalCocktail_CellRanger.csv",sep=";")
Hashtags = read.csv("docs/AbInfo/TotalSeqC_Human_HashtagAntibodies.csv")
WorkSet = read.csv("data/98_miscellaneous/TRANS_017_Antibodies.csv",sep=";")
WorkSet
Universal
library(tidyverse)
setwd("C:/Users/asbarros/OneDrive - FUNDAÇÃO GIMM - GULBENKIAN INSTITUTE FOR MOLECULAR MEDICINE/ADA/BSSantos/TRANS_017/")
Universal = read.csv("docs/AbInfo/TotalSeqC_Human_UniversalCocktail_CellRanger.csv",sep=",")
Hashtags = read.csv("docs/AbInfo/TotalSeqC_Human_HashtagAntibodies.csv",sep=",")
WorkSet = read.csv("data/98_miscellaneous/TRANS_017_Antibodies.csv",sep=";")
WorkSet
library(tidyverse)
setwd("C:/Users/asbarros/OneDrive - FUNDAÇÃO GIMM - GULBENKIAN INSTITUTE FOR MOLECULAR MEDICINE/ADA/BSSantos/TRANS_017/")
Universal = read.csv("docs/AbInfo/TotalSeqC_Human_UniversalCocktail_CellRanger.csv",sep=",")
Hashtags = read.csv("docs/AbInfo/TotalSeqC_Human_HashtagAntibodies.csv",sep=",")
WorkSet = read.csv("data/98_miscellaneous/TRANS_017_Antibodies.csv",sep=";") %>%
mutate(AbName <- iconv(AbName, from = "latin1", to = "UTF-8"))
WorkSet
library(tidyverse)
setwd("C:/Users/asbarros/OneDrive - FUNDAÇÃO GIMM - GULBENKIAN INSTITUTE FOR MOLECULAR MEDICINE/ADA/BSSantos/TRANS_017/")
Universal = read.csv("docs/AbInfo/TotalSeqC_Human_UniversalCocktail_CellRanger.csv",sep=",")
Hashtags = read.csv("docs/AbInfo/TotalSeqC_Human_HashtagAntibodies.csv",sep=",")
WorkSet = read.csv("data/98_miscellaneous/TRANS_017_Antibodies.csv",sep=";") %>%
mutate(AbName = iconv(AbName, from = "latin1", to = "UTF-8"))
WorkSet
library(tidyverse)
setwd("C:/Users/asbarros/OneDrive - FUNDAÇÃO GIMM - GULBENKIAN INSTITUTE FOR MOLECULAR MEDICINE/ADA/BSSantos/TRANS_017/")
Universal = read.csv("docs/AbInfo/TotalSeqC_Human_UniversalCocktail_CellRanger.csv",sep=",")
Hashtags = read.csv("docs/AbInfo/TotalSeqC_Human_HashtagAntibodies.csv",sep=",")
WorkSet = read.csv("data/98_miscellaneous/TRANS_017_Antibodies.csv",sep=";") %>%
mutate(AbName = iconv(AbName, from = "latin1", to = "UTF-8")) %>%
mutate(AbName =str_remove_all(AbName, "\u0099"))
WorkSet
library(tidyverse)
setwd("C:/Users/asbarros/OneDrive - FUNDAÇÃO GIMM - GULBENKIAN INSTITUTE FOR MOLECULAR MEDICINE/ADA/BSSantos/TRANS_017/")
Universal = read.csv("docs/AbInfo/TotalSeqC_Human_UniversalCocktail_CellRanger.csv",sep=",")
Hashtags = read.csv("docs/AbInfo/TotalSeqC_Human_HashtagAntibodies.csv",sep=",")
WorkSet = read.csv("data/98_miscellaneous/TRANS_017_Antibodies.csv",sep=";") %>%
mutate(AbName = iconv(AbName, from = "latin1", to = "UTF-8")) %>%
mutate(AbName =str_remove_all(AbName, "\u0099"), AbID = str_extract(AbName, "C\\d{4}"))
WorkSet
Universal
library(tidyverse)
setwd("C:/Users/asbarros/OneDrive - FUNDAÇÃO GIMM - GULBENKIAN INSTITUTE FOR MOLECULAR MEDICINE/ADA/BSSantos/TRANS_017/")
Universal = read.csv("docs/AbInfo/TotalSeqC_Human_UniversalCocktail_CellRanger.csv",sep=",")
Hashtags = read.csv("docs/AbInfo/TotalSeqC_Human_HashtagAntibodies.csv",sep=",")
WorkSet = read.csv("data/98_miscellaneous/TRANS_017_Antibodies.csv",sep=";") %>%
mutate(AbName = iconv(AbName, from = "latin1", to = "UTF-8")) %>%
mutate(AbName =str_remove_all(AbName, "\u0099"))
Ab_IDs=str_extract(df$AbName, "C\\d{4}")
library(tidyverse)
setwd("C:/Users/asbarros/OneDrive - FUNDAÇÃO GIMM - GULBENKIAN INSTITUTE FOR MOLECULAR MEDICINE/ADA/BSSantos/TRANS_017/")
Universal = read.csv("docs/AbInfo/TotalSeqC_Human_UniversalCocktail_CellRanger.csv",sep=",")
Hashtags = read.csv("docs/AbInfo/TotalSeqC_Human_HashtagAntibodies.csv",sep=",")
WorkSet = read.csv("data/98_miscellaneous/TRANS_017_Antibodies.csv",sep=";") %>%
mutate(AbName = iconv(AbName, from = "latin1", to = "UTF-8")) %>%
mutate(AbName =str_remove_all(AbName, "\u0099"))
Ab_IDs=str_extract(WorkSet$AbName, "C\\d{4}")
Ab_IDs
library(tidyverse)
setwd("C:/Users/asbarros/OneDrive - FUNDAÇÃO GIMM - GULBENKIAN INSTITUTE FOR MOLECULAR MEDICINE/ADA/BSSantos/TRANS_017/")
Universal = read.csv("docs/AbInfo/TotalSeqC_Human_UniversalCocktail_CellRanger.csv",sep=",")
Hashtags = read.csv("docs/AbInfo/TotalSeqC_Human_HashtagAntibodies.csv",sep=",")
WorkSet = read.csv("data/98_miscellaneous/TRANS_017_Antibodies.csv",sep=";") %>%
mutate(AbName = iconv(AbName, from = "latin1", to = "UTF-8")) %>%
mutate(AbName =str_remove_all(AbName, "\u0099"))
Ab_IDs=str_extract(WorkSet$AbName, "C\\d{4}")
Ab_IDs_singlestring=paste0(Ab_IDs,collapse = "|")
Universal %>% head()
library(tidyverse)
setwd("C:/Users/asbarros/OneDrive - FUNDAÇÃO GIMM - GULBENKIAN INSTITUTE FOR MOLECULAR MEDICINE/ADA/BSSantos/TRANS_017/")
Universal = read.csv("docs/AbInfo/TotalSeqC_Human_UniversalCocktail_CellRanger.csv",sep=",")
Hashtags = read.csv("docs/AbInfo/TotalSeqC_Human_HashtagAntibodies.csv",sep=",")
WorkSet = read.csv("data/98_miscellaneous/TRANS_017_Antibodies.csv",sep=";") %>%
mutate(AbName = iconv(AbName, from = "latin1", to = "UTF-8")) %>%
mutate(AbName =str_remove_all(AbName, "\u0099"))
Ab_IDs=str_extract(WorkSet$AbName, "C\\d{4}")
Ab_IDs_singlestring=paste0(Ab_IDs,collapse = "|")
WorkSet_CellRanger = bind_rows(
Universal %>% filter(grepl(Ab_IDs,id)==T),
Hashtags %>% filter(grepl(Ab_IDs,id)==T)
)
Universal %>% filter(grepl(Ab_IDs,id)==T)
Ab_IDs
library(tidyverse)
setwd("C:/Users/asbarros/OneDrive - FUNDAÇÃO GIMM - GULBENKIAN INSTITUTE FOR MOLECULAR MEDICINE/ADA/BSSantos/TRANS_017/")
Universal = read.csv("docs/AbInfo/TotalSeqC_Human_UniversalCocktail_CellRanger.csv",sep=",")
Hashtags = read.csv("docs/AbInfo/TotalSeqC_Human_HashtagAntibodies.csv",sep=",")
WorkSet = read.csv("data/98_miscellaneous/TRANS_017_Antibodies.csv",sep=";") %>%
mutate(AbName = iconv(AbName, from = "latin1", to = "UTF-8")) %>%
mutate(AbName =str_remove_all(AbName, "\u0099"))
Ab_IDs=str_extract(WorkSet$AbName, "C\\d{4}")
Ab_IDs_singlestring=paste0(Ab_IDs,collapse = "|")
WorkSet_CellRanger = bind_rows(
Universal %>% filter(grepl(Ab_IDs_singlestring,id)==T),
Hashtags %>% filter(grepl(Ab_IDs_singlestring,id)==T)
)
WorkSet_CellRanger
library(tidyverse)
setwd("C:/Users/asbarros/OneDrive - FUNDAÇÃO GIMM - GULBENKIAN INSTITUTE FOR MOLECULAR MEDICINE/ADA/BSSantos/TRANS_017/")
Universal = read.csv("docs/AbInfo/TotalSeqC_Human_UniversalCocktail_CellRanger.csv",sep=",")
Hashtags = read.csv("docs/AbInfo/TotalSeqC_Human_HashtagAntibodies.csv",sep=",")
WorkSet = read.csv("data/98_miscellaneous/TRANS_017_Antibodies.csv",sep=";") %>%
mutate(AbName = iconv(AbName, from = "latin1", to = "UTF-8")) %>%
mutate(AbName =str_remove_all(AbName, "\u0099"))
Ab_IDs=str_extract(WorkSet$AbName, "C\\d{4}")
Ab_IDs_singlestring=paste0(Ab_IDs,collapse = "|")
WorkSet_CellRanger = bind_rows(
Universal %>% filter(grepl(Ab_IDs_singlestring,id)==T),
Hashtags %>% filter(grepl(Ab_IDs_singlestring,id)==T)
) %>% select(-X)
WorkSet_CellRanger
library(tidyverse)
setwd("C:/Users/asbarros/OneDrive - FUNDAÇÃO GIMM - GULBENKIAN INSTITUTE FOR MOLECULAR MEDICINE/ADA/BSSantos/TRANS_017/")
Universal = read.csv("docs/AbInfo/TotalSeqC_Human_UniversalCocktail_CellRanger.csv",sep=",")
Hashtags = read.csv("docs/AbInfo/TotalSeqC_Human_HashtagAntibodies.csv",sep=",") %>%
Mutate(feature_type="Multiplexing Captura")
library(tidyverse)
setwd("C:/Users/asbarros/OneDrive - FUNDAÇÃO GIMM - GULBENKIAN INSTITUTE FOR MOLECULAR MEDICINE/ADA/BSSantos/TRANS_017/")
Universal = read.csv("docs/AbInfo/TotalSeqC_Human_UniversalCocktail_CellRanger.csv",sep=",")
Hashtags = read.csv("docs/AbInfo/TotalSeqC_Human_HashtagAntibodies.csv",sep=",") %>%
mutate(feature_type="Multiplexing Capture")
WorkSet = read.csv("data/98_miscellaneous/TRANS_017_Antibodies.csv",sep=";") %>%
mutate(AbName = iconv(AbName, from = "latin1", to = "UTF-8")) %>%
mutate(AbName =str_remove_all(AbName, "\u0099"))
Ab_IDs=str_extract(WorkSet$AbName, "C\\d{4}")
Ab_IDs_singlestring=paste0(Ab_IDs,collapse = "|")
WorkSet_CellRanger = bind_rows(
Universal %>% filter(grepl(Ab_IDs_singlestring,id)==T),
Hashtags %>% filter(grepl(Ab_IDs_singlestring,id)==T)
) %>% select(-X)
write.csv(WorkSet_CellRanger,"data/98_miscellaneous/feature_type.csv")
WorkSet_CellRanger
library(tidyverse)
setwd("C:/Users/asbarros/OneDrive - FUNDAÇÃO GIMM - GULBENKIAN INSTITUTE FOR MOLECULAR MEDICINE/ADA/BSSantos/TRANS_017/")
Universal = read.csv("docs/AbInfo/TotalSeqC_Human_UniversalCocktail_CellRanger.csv",sep=",")
Hashtags = read.csv("docs/AbInfo/TotalSeqC_Human_HashtagAntibodies.csv",sep=",") %>%
mutate(feature_type="Multiplexing Capture")
WorkSet = read.csv("data/98_miscellaneous/TRANS_017_Antibodies.csv",sep=";") %>%
mutate(AbName = iconv(AbName, from = "latin1", to = "UTF-8")) %>%
mutate(AbName =str_remove_all(AbName, "\u0099"))
Ab_IDs=str_extract(WorkSet$AbName, "C\\d{4}")
Ab_IDs_singlestring=paste0(Ab_IDs,collapse = "|")
WorkSet_CellRanger = bind_rows(
Universal %>% filter(grepl(Ab_IDs_singlestring,id)==T),
Hashtags %>% filter(grepl(Ab_IDs_singlestring,id)==T)
) %>% select(-X)
write.csv(WorkSet_CellRanger,"data/98_miscellaneous/feature_type.csv",row.names = F)
library(tidyverse)
setwd("C:/Users/asbarros/OneDrive - FUNDAÇÃO GIMM - GULBENKIAN INSTITUTE FOR MOLECULAR MEDICINE/ADA/BSSantos/TRANS_017/")
Universal = read.csv("docs/AbInfo/TotalSeqC_Human_UniversalCocktail_CellRanger.csv",sep=",")
Hashtags = read.csv("docs/AbInfo/TotalSeqC_Human_HashtagAntibodies.csv",sep=",") %>%
mutate(feature_type="Multiplexing Capture")
WorkSet = read.csv("data/98_miscellaneous/TRANS_017_Antibodies.csv",sep=";") %>%
mutate(AbName = iconv(AbName, from = "latin1", to = "UTF-8")) %>%
mutate(AbName =str_remove_all(AbName, "\u0099"))
Ab_IDs=str_extract(WorkSet$AbName, "C\\d{4}")
Ab_IDs_singlestring=paste0(Ab_IDs,collapse = "|")
WorkSet_CellRanger = bind_rows(
Universal %>% filter(grepl(Ab_IDs_singlestring,id)==T),
Hashtags %>% filter(grepl(Ab_IDs_singlestring,id)==T)
) %>% select(-X)
write.csv(WorkSet_CellRanger,"data/98_miscellaneous/TRANS_017_feature_type.csv",row.names = F)
nrow(WorkSet_CellRanger)
